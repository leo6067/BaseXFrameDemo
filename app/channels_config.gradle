apply plugin: 'walle'


android {

//    defaultConfig {
//        buildConfigField "String", "CHANNEL_TYPE", "\"${rootProject.ext.android.channel}\""
//    }

    signingConfigs {
        normal {
            // 签名store文件路径
            storeFile file('../dqvideo.jks')
            storePassword 'dqvideo'
            keyAlias 'dqvideo'
            keyPassword 'dqvideo'
        }


        haolu {

        }
    }

    //walle多渠道和马甲包配置
    productFlavors {
        xysp {
            applicationId "com.xy.basedemo"
            versionCode rootProject.ext.versionCode
            versionName rootProject.ext.versionName
            manifestPlaceholders = [
                    //友盟配置
                    APP_CHANNEL_VALUE : "xysp_yingyongbao",
            ]
            signingConfig signingConfigs.normal
        }
        tlsp {//特殊的桃乐，所有配置均与茜柚一直，包括包名都要一样的，并不是我忘记改了，不要问我为什么，接受事实就好
            applicationId "com.mg.xyvideo"
            versionCode rootProject.ext.versionCode
            versionName rootProject.ext.versionName
            manifestPlaceholders = [
                    UMENG_APPKEY      : "5d59ff453fc195a47d000c8c",
            ]
            // 友盟
            buildConfigField "String", "UM_PUSH_SECRET", "\"d143e8fde23aa21397d80c97a71e03e5\""
            signingConfig signingConfigs.normal
        }
    }
}

//android.applicationVariants.all { variant ->
//    variant.outputs.all {
//        if (variant.productFlavors[0] == null) {
//            outputFileName = "qiyoutui_v${variant.versionName}_build${variant.versionCode}.apk"
//        } else {
//            outputFileName = "${variant.productFlavors[0].name}_v${variant.versionName}_build${variant.versionCode}.apk"
//        }
//    }
//}

walle {
    // 指定渠道包的输出路径
    apkOutputFolder = new File("${project.buildDir}/${rootProject.ext.channel}")
    println ">>>>>> apkOutputFolder = ${apkOutputFolder.getAbsolutePath()}"
    // 定制渠道包的APK的文件名称 ${appName}-${packageName}-${channels_hhcr}-${buildType}-v${versionName}-${versionCode}-${buildTime}.apk
    apkFileNameFormat = '${appName}_${channel}-v${versionName}-${versionCode}-${buildTime}.apk'

    // 渠道配置文件
//    channelFile = new File("${project.getProjectDir()}/channels/channels_${rootProject.ext.channel}")
//    channelFile = new File("${project.getProjectDir()}/channel")
//    : rootProject.file('channel_file')
    channelFile =    new File("${project.getProjectDir()}/channel")
    println ">>>>>> channelFile = ${channelFile.getAbsolutePath()}"
}
